<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>武器改装交互图 - Canvas</title>
<style>
  body { display: flex; font-family: sans-serif; }
  #details { margin-left: 20px; padding: 10px; width: 320px; border: 1px solid #ccc; background: #fafafa; }
</style>
</head>
<body>

<canvas id="mapCanvas" width="900" height="900" style="border:1px solid #ccc;"></canvas>

<div id="details">
  <h3>改装方案</h3>
  <div id="weaponName">点击武器查看方案</div>
  <div id="weaponMods"></div>
</div>

<script>
const ctx = document.getElementById('mapCanvas').getContext('2d');

// 背景绘制（示例：网格 + 中心圆）
function drawBackground() {
  ctx.fillStyle = "#eaeaea";
  ctx.fillRect(0, 0, 900, 900);

  ctx.strokeStyle = "#ccc";
  for (let x = 0; x <= 900; x += 50) {
    ctx.beginPath();
    ctx.moveTo(x, 0);
    ctx.lineTo(x, 900);
    ctx.stroke();
  }
  for (let y = 0; y <= 900; y += 50) {
    ctx.beginPath();
    ctx.moveTo(0, y);
    ctx.lineTo(900, y);
    ctx.stroke();
  }

  ctx.strokeStyle = "#999";
  ctx.beginPath();
  ctx.arc(450, 450, 200, 0, Math.PI * 2);
  ctx.stroke();
}

const weapons = [
  { name: "M4A1", x: 450, y: 450, color: "green" },
  { name: "SCAR-H", x: 414, y: 360, color: "orange" },
  { name: "AKM", x: 396, y: 405, color: "orange" },
  { name: "G3", x: 468, y: 342, color: "orange" },
  { name: "M7", x: 468, y: 225, color: "orange" }
  // 其他武器依次添加
];

function drawWeapons() {
  weapons.forEach(w => {
    ctx.beginPath();
    ctx.arc(w.x, w.y, 8, 0, Math.PI * 2);
    ctx.fillStyle = w.color;
    ctx.fill();
    ctx.strokeStyle = "#fff";
    ctx.lineWidth = 2;
    ctx.stroke();
  });
}

const weaponData = {
  "M4A1": [
    { name: "轻型改装", code: "M4A1_LITE", price: 500 },
    { name: "远程狙击型", code: "M4A1_SNIPER", price: 800 },
    { name: "全能型", code: "M4A1_BALANCE", price: 650 }
  ],
  "SCAR-H": [
    { name: "高威力型", code: "SCAR-H_POWER", price: 900 },
    { name: "远射程型", code: "SCAR-H_LONG", price: 1000 },
    { name: "轻量化型", code: "SCAR-H_LITE", price: 850 }
  ]
};

// 点击检测
document.getElementById('mapCanvas').addEventListener('click', e => {
  const rect = e.target.getBoundingClientRect();
  const mouseX = e.clientX - rect.left;
  const mouseY = e.clientY - rect.top;

  weapons.forEach(w => {
    const dx = mouseX - w.x;
    const dy = mouseY - w.y;
    if (Math.sqrt(dx*dx + dy*dy) < 8) {
      const mods = weaponData[w.name] || [];
      document.getElementById('weaponName').textContent = w.name;
      document.getElementById('weaponMods').innerHTML = mods.map(m => `
        <div><b>${m.name}</b></div>
        <div>代码: ${m.code}</div>
        <div>价格: ${m.price} 元</div>
      `).join('<hr>');
    }
  });
});

// 初始绘制
drawBackground();
drawWeapons();
</script>

</body>
</html>
