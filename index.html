<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>武器改装交互图</title>
<style>
  body { display: flex; font-family: sans-serif; }
  #details {
    margin-left: 20px;
    padding: 10px;
    width: 320px;
    border: 1px solid #ccc;
    background: #fafafa;
  }
</style>
</head>
<body>

<canvas id="mapCanvas" width="900" height="900" style="border:1px solid #ccc;"></canvas>

<div id="details">
  <h3>改装方案</h3>
  <div id="weaponName">点击武器查看方案</div>
  <div id="weaponMods"></div>
</div>

<script>
const canvas = document.getElementById('mapCanvas');
const ctx = canvas.getContext('2d');

const centerX = canvas.width / 2;
const centerY = canvas.height / 2;

// 逻辑坐标范围 [-10, 10]，对应像素映射
const logicRange = 10;
const scale = (canvas.width / 2) / logicRange; // 每单位逻辑坐标对应像素

// 绘制坐标轴和象限
function drawAxes() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  ctx.fillStyle = "#fff";
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  ctx.strokeStyle = "#000";
  ctx.lineWidth = 2;

  // X 轴
  ctx.beginPath();
  ctx.moveTo(0, centerY);
  ctx.lineTo(canvas.width, centerY);
  ctx.stroke();

  // Y 轴
  ctx.beginPath();
  ctx.moveTo(centerX, 0);
  ctx.lineTo(centerX, canvas.height);
  ctx.stroke();

  // 坐标轴标签
  ctx.font = "20px sans-serif";
  ctx.fillStyle = "#000";
  ctx.textAlign = "center";
  ctx.fillText("控枪容易程度 →", canvas.width - 100, centerY - 10);

  ctx.save();
  ctx.translate(centerX - 60, 50);
  ctx.rotate(-Math.PI / 2);
  ctx.fillText("作战距离 →", 0, 0);
  ctx.restore();

  // 象限标签
  ctx.font = "bold 60px sans-serif";
  ctx.fillStyle = "rgba(200,200,200,0.5)";
  ctx.textAlign = "center";
  ctx.fillText("高手", centerX - 200, centerY - 200);
  ctx.fillText("新手", centerX + 200, centerY - 200);
  ctx.fillText("莽子", centerX - 200, centerY + 200);
  ctx.fillText("角子", centerX + 200, centerY + 200);
}

// 武器数据（逻辑坐标）
const weapons = [
  { name: "M4A1", x: 0, y: 0, color: "green" },
  { name: "腾龙", x: 3, y: 2, color: "red" },
  { name: "SR-3M", x: 5, y: 2, color: "red" },
  { name: "AS VAL", x: -6, y: -6, color: "red" },
  { name: "AKM", x: -2, y: 4.5, color: "orange" },
  { name: "G3", x: 0, y: 8, color: "orange" },
  { name: "M7", x: -1, y: 5, color: "orange" },
  { name: "SCAR-H", x: -4, y: 9, color: "green" }
];

// 改装方案
const weaponData = {
  "M4A1": [
    { name: "轻型改装", code: "M4A1_LITE", price: 500 },
    { name: "远程狙击型", code: "M4A1_SNIPER", price: 800 },
    { name: "全能型", code: "M4A1_BALANCE", price: 650 }
  ],
  "SCAR-H": [
    { name: "高威力型", code: "SCAR-H_POWER", price: 900 },
    { name: "远射程型", code: "SCAR-H_LONG", price: 1000 },
    { name: "轻量化型", code: "SCAR-H_LITE", price: 850 }
  ]
};

// 逻辑坐标转像素坐标
function logicToPixelX(x) {
  return centerX + x * scale;
}
function logicToPixelY(y) {
  return centerY - y * scale;
}

// 绘制武器点
function drawWeapons() {
  weapons.forEach(w => {
    ctx.beginPath();
    ctx.arc(logicToPixelX(w.x), logicToPixelY(w.y), 8, 0, Math.PI * 2);
    ctx.fillStyle = w.color;
    ctx.fill();
    ctx.strokeStyle = "#fff";
    ctx.lineWidth = 2;
    ctx.stroke();
  });
}

// 点击事件
canvas.addEventListener('click', e => {
  const rect = canvas.getBoundingClientRect();
  const mouseX = e.clientX - rect.left;
  const mouseY = e.clientY - rect.top;

  weapons.forEach(w => {
    const dx = mouseX - logicToPixelX(w.x);
    const dy = mouseY - logicToPixelY(w.y);
    if (Math.sqrt(dx*dx + dy*dy) < 8) {
      const mods = weaponData[w.name] || [];
      document.getElementById('weaponName').textContent = w.name;
      document.getElementById('weaponMods').innerHTML = mods.map(m => `
        <div><b>${m.name}</b></div>
        <div>代码: ${m.code}</div>
        <div>价格: ${m.price} 元</div>
      `).join('<hr>');
    }
  });
});

// 初始化
drawAxes();
drawWeapons();
</script>

</body>
</html>
